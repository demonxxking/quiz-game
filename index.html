<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bharat Quiz Challenge</title>
    <style>
        /* [Previous CSS remains exactly the same] */
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ‡®ðŸ‡³ Bharat Quiz Challenge</h1>
        <div class="question-counter">Question: <span id="question-count">1</span>/âˆž</div>
        <div class="score-display">Score: <span id="score">0</span></div>
        <div class="timer-container">
            <div class="timer-bar" id="timer-bar"></div>
        </div>
        <div class="timer-text" id="timer-text">30s</div>
        <div class="question-box" id="question"></div>
        <div class="options-container" id="options"></div>
        <div class="feedback" id="feedback"></div>
    </div>

    <script>
        class QuizEngine {
            constructor() {
                this.usedQuestions = new Set();
                this.allQuestions = this.initializeQuestions();
            }

            initializeQuestions() {
                // Pre-defined questions to ensure we always have content
                return [
                    // Math Questions (30)
                    ...Array.from({length: 10}, (_,i) => this.createMathQuestion('+', 1, 10)),
                    ...Array.from({length: 10}, (_,i) => this.createMathQuestion('-', 1, 10)),
                    ...Array.from({length: 5}, (_,i) => this.createMathQuestion('*', 1, 5)),
                    ...Array.from({length: 5}, (_,i) => this.createMathQuestion('/', 1, 5)),
                    
                    // Physics (10)
                    { q: "What is the unit of force?", a: "Newton", opts: ["Joule", "Newton", "Watt", "Pascal"], cat: "physics" },
                    { q: "Which law states 'For every action there is an equal and opposite reaction'?", 
                      a: "Newton's Third Law", opts: ["Newton's First Law", "Newton's Second Law", "Newton's Third Law", "Law of Gravitation"], cat: "physics" },
                    
                    // Chemistry (10)
                    { q: "What is the chemical symbol for Gold?", a: "Au", opts: ["Ag", "Au", "Gd", "Go"], cat: "chemistry" },
                    { q: "What is the pH value of pure water?", a: "7", opts: ["5", "6", "7", "8"], cat: "chemistry" },
                    
                    // History (20)
                    { q: "Who was the first Prime Minister of India?", 
                      a: "Jawaharlal Nehru", opts: ["Mahatma Gandhi", "Jawaharlal Nehru", "Indira Gandhi", "Sardar Patel"], cat: "history" },
                    { q: "In which year did India gain independence?", 
                      a: "1947", opts: ["1945", "1947", "1950", "1935"], cat: "history" },
                    
                    // Culture (20)
                    { q: "Which classical dance form originated in Kerala?", 
                      a: "Kathakali", opts: ["Bharatanatyam", "Kathak", "Kathakali", "Odissi"], cat: "culture" },
                    { q: "Which festival is known as the 'Festival of Lights'?", 
                      a: "Diwali", opts: ["Holi", "Diwali", "Dussehra", "Navratri"], cat: "culture" }
                ];
            }

            createMathQuestion(op, min, max) {
                let num1 = Math.floor(Math.random() * max) + min;
                let num2 = Math.floor(Math.random() * max) + min;
                let answer, question;

                if (op === '/') {
                    answer = Math.floor(Math.random() * 5) + 1;
                    num2 = Math.floor(Math.random() * 5) + 1;
                    num1 = answer * num2;
                    question = `${num1} Ã· ${num2}`;
                } else {
                    question = `${num1} ${op === '*' ? 'Ã—' : op} ${num2}`;
                    answer = eval(num1 + op + num2); // Safe here because we control the inputs
                }

                return {
                    q: `What is ${question}?`,
                    a: answer,
                    opts: this.generateMathOptions(answer, op),
                    cat: "math"
                };
            }

            generateMathOptions(answer, op) {
                const options = [answer];
                while (options.length < 4) {
                    let option;
                    if (op === '/' || op === '*') {
                        option = answer + (Math.floor(Math.random() * 5) - 2;
                    } else {
                        option = answer + (Math.floor(Math.random() * 10) - 5;
                    }
                    if (option !== answer && !options.includes(option) && option > 0) {
                        options.push(option);
                    }
                }
                return options.sort(() => Math.random() - 0.5);
            }

            getRandomQuestion() {
                // If we've used all questions, reset (shouldn't happen with infinite mode)
                if (this.usedQuestions.size >= this.allQuestions.length) {
                    this.usedQuestions.clear();
                }

                let availableQuestions = this.allQuestions.filter(q => !this.usedQuestions.has(q.q));
                if (availableQuestions.length === 0) {
                    availableQuestions = this.allQuestions;
                    this.usedQuestions.clear();
                }

                const randomIndex = Math.floor(Math.random() * availableQuestions.length);
                const question = availableQuestions[randomIndex];
                this.usedQuestions.add(question.q);
                return question;
            }

            generateQuestion(difficulty) {
                const baseQuestion = this.getRandomQuestion();
                
                // For math questions, increase difficulty based on score
                if (baseQuestion.cat === 'math') {
                    return this.createMathQuestion(
                        ['+', '-', '*', '/'][Math.min(Math.floor(difficulty/5), 3)],
                        1 + difficulty,
                        10 + difficulty * 2
                    );
                }
                
                return baseQuestion;
            }
        }

        class GameController {
            constructor() {
                this.engine = new QuizEngine();
                this.score = 0;
                this.questionCount = 1;
                this.timeLeft = 30;
                this.timer = null;

                this.elements = {
                    question: document.getElementById('question'),
                    options: document.getElementById('options'),
                    score: document.getElementById('score'),
                    feedback: document.getElementById('feedback'),
                    timerBar: document.getElementById('timer-bar'),
                    timerText: document.getElementById('timer-text'),
                    questionCount: document.getElementById('question-count')
                };

                this.loadQuestion();
            }

            loadQuestion() {
                clearInterval(this.timer);
                
                this.timeLeft = this.questionCount <= 20 ? 30 : 10;
                this.updateTimerDisplay();
                
                const question = this.engine.generateQuestion(this.score);
                this.currentQuestion = question;
                
                this.elements.question.innerHTML = question.q + ` <span class="category-tag">${question.cat.toUpperCase()}</span>`;
                this.elements.questionCount.textContent = this.questionCount;
                this.elements.options.innerHTML = '';
                
                question.opts.forEach(option => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = option;
                    btn.addEventListener('click', () => this.checkAnswer(option));
                    this.elements.options.appendChild(btn);
                });

                this.timer = setInterval(() => {
                    this.timeLeft--;
                    this.updateTimerDisplay();
                    
                    if (this.timeLeft <= 0) {
                        this.handleTimeout();
                    }
                }, 1000);
            }

            updateTimerDisplay() {
                const maxTime = this.questionCount <= 20 ? 30 : 10;
                this.elements.timerBar.style.width = `${(this.timeLeft/maxTime)*100}%`;
                this.elements.timerText.textContent = `${this.timeLeft}s`;
                this.elements.timerBar.style.background = this.timeLeft <= 5 ? '#e74c3c' : '#f4d03f';
            }

            checkAnswer(selected) {
                clearInterval(this.timer);
                const isCorrect = selected == this.currentQuestion.a;
                
                if (isCorrect) {
                    this.score++;
                    this.elements.feedback.textContent = 'âœ“ Correct! +1';
                    this.elements.feedback.className = 'feedback correct';
                } else {
                    this.score = Math.max(0, this.score - 1);
                    this.elements.feedback.textContent = `âœ— Wrong! Answer: ${this.currentQuestion.a}`;
                    this.elements.feedback.className = 'feedback incorrect';
                }
                
                this.elements.score.textContent = this.score;
                this.questionCount++;
                setTimeout(() => this.loadQuestion(), 1000);
            }

            handleTimeout() {
                clearInterval(this.timer);
                this.score = Math.max(0, this.score - 1);
                this.elements.score.textContent = this.score;
                this.elements.feedback.textContent = "â° Time's up! -1";
                this.elements.feedback.className = 'feedback incorrect';
                this.questionCount++;
                setTimeout(() => this.loadQuestion(), 1500);
            }
        }

        // Start the game
        new GameController();
    </script>
</body>
</html>
